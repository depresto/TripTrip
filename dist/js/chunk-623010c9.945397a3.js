(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-623010c9"],{"029e":function(t,e,i){},1511:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"user-root"}},[i("user-profile",{attrs:{user:t.user,isMyself:t.checkMyself},on:{changeAvatar:t.changeAvatar,onEditMode:function(e){t.isOnEditMode=!0}}}),i("div",{staticClass:"record-container"},[0!==t.user.collectingSites.length?i("div",[i("h5",[t._v(t._s(t.user.username)+"收藏的景點")]),i("div",t._l(t.user.collectingSites.slice(t.indexs.idx1,t.equalOrLess2(t.user.collectingSites.length)+t.indexs.idx1),function(t){return i("little-card",{key:"little-card-"+t.name,attrs:{item:t,type:"site"}})}),1),i("v-icon",{on:{click:function(e){return t.back("idx1")}}},[t._v("arrow_back_ios")]),i("v-icon",{on:{click:function(e){return t.forward("idx1",t.user.collectingSites.length)}}},[t._v("arrow_forward_ios")])],1):t._e(),0!==t.user.owningTrips.length?i("div",[i("h5",[t._v(t._s(t.user.username)+"建立的行程")]),i("div",t._l(t.user.owningTrips,function(t){return i("little-card",{key:"little-card-"+t.name,attrs:{item:t,type:"trip"}})}),1),i("v-icon",{on:{click:function(e){return t.back("idx2")}}},[t._v("arrow_back_ios")]),i("v-icon",{on:{click:function(e){return t.forward("idx2",t.user.owningTrips.length)}}},[t._v("arrow_forward_ios")])],1):t._e(),0!==t.user.collectingTrips.length?i("div",[i("h5",[t._v(t._s(t.user.username)+"收藏的行程")]),i("div",t._l(t.user.collectingTrips.slice(t.indexs.idx3,t.equalOrLess2(t.user.collectingTrips.length)+t.indexs.idx3),function(t){return i("little-card",{key:"little-card-"+t.name,attrs:{item:t,type:"tirp"}})}),1),i("v-icon",{on:{click:function(e){return t.back("idx3")}}},[t._v("arrow_back_ios")]),i("v-icon",{on:{click:function(e){return t.forward("idx3",t.user.collectingTrips.length)}}},[t._v("arrow_forward_ios")])],1):t._e()]),t.isOnEditMode?i("div",{staticClass:"edit-container"},[i("v-card",{attrs:{"min-width":"400"}},[i("h4",[t._v("編輯你的個人資料")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.confirm(e)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[i("v-text-field",{attrs:{rules:t.usernameRules,label:"Name",required:"",outlined:""},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}}),i("v-textarea",{attrs:{rules:t.introductionRules,name:"introduction",label:"Introduction",outlined:""},model:{value:t.user.introduction,callback:function(e){t.$set(t.user,"introduction",e)},expression:"user.introduction"}}),i("div",{staticClass:"btn-group"},[i("v-btn",{attrs:{type:"submit",color:"#009499"}},[t._v("確定")]),i("v-btn",{attrs:{color:"error"},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)],1):t._e()],1)},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-profile-root"},[i("div",[i("v-avatar",{attrs:{size:"100"}},[i("img",{attrs:{src:t.user.avatar,alt:"John"}})]),t.isMyself?i("input",{attrs:{type:"file",id:"avatar"},on:{change:t.uploadAvatar}}):t._e(),i("label",{attrs:{for:"avatar"}},[t._v("更改相片")])],1),i("div",[i("h3",[t._v("嗨！我是"+t._s(t.user.username))]),i("p",[t._v(t._s(t.user.introduction))])]),i("div",[i("div",[i("v-icon",[t._v("email")]),i("p",[t._v(t._s(t.user.email))])],1),i("div",[i("v-icon",[t._v("today")]),i("p",[t._v("已建立"+t._s(t.user.owningTrips.length)+"個行程")])],1),i("div",[i("v-icon",{attrs:{color:"red"}},[t._v("favorite")]),i("p",[t._v("已收藏"+t._s(t.user.collectingTrips.length)+"個行程")])],1),i("div",[i("v-icon",{attrs:{color:"#FB9026"}},[t._v("emoji_events")]),i("p",[t._v("行程已被收藏"+t._s(t.haveBeenCollectingCounts)+"次")])],1),t.isMyself?i("div",[i("button",{on:{click:function(e){return t.$emit("onEditMode")}}},[t._v("編輯個人資料")])]):t._e()]),i("span",[t._v("加入時間:   "+t._s(new Date(t.user.createdAt).toDateString()))])])},o=[],a=i("2f62"),c={props:{user:Object,isMyself:Boolean},computed:{haveBeenCollectingCounts(){return this.user.owningTrips.reduce((t,e)=>e.collectingCounts+t,0)}},methods:{...Object(a["b"])("account",["editProfile"]),uploadAvatar(t){const e=t.target.files[0];this.$emit("changeAvatar",e);const i=new FormData;i.append("image",e),this.editProfile(i)}}},l=c,u=(i("c83b"),i("2877")),d=i("6544"),h=i.n(d),m=i("8212"),v=i("132d"),g=Object(u["a"])(l,r,o,!1,null,"3e546436",null),p=g.exports;h()(g,{VAvatar:m["a"],VIcon:v["a"]});var f=i("52f9"),w=i("a27e"),_={getUser(t){return w["a"].get(`/users/${t}`)},getUserProfile(t){return w["a"].get(`/users/${t}/profile`)}},b=i("0e8e"),y={components:{UserProfile:p,LittleCard:f["a"]},data(){return{user:{collectingTrips:[],collectingSites:[],owningTrips:[]},indexs:{idx1:0,idx2:0,idx3:0},isOnEditMode:!1,valid:!0,originUsername:"",originIntroduction:"",usernameRules:[t=>!!t||"Name is required",t=>t&&t.length<=10||"Name must be less than 10 characters"],introductionRules:[t=>t.length<=100||"Name must be less than 100 characters"]}},async created(){const{data:t}=await _.getUserProfile(this.$route.params.id);t.collectingSites=Object(b["b"])(t.collectingSites),this.user=t},computed:{...Object(a["c"])("account",{accountId:"getAccountId"}),checkMyself(){return this.user._id===this.accountId}},methods:{...Object(a["d"])("account",["SET_avatar"]),...Object(a["b"])("account",["editProfile"]),equalOrLess2(t){return t>=2?2:t},back(t){return this.indexs[t]-1<0?0:this.indexs[t]--},forward(t,e){return this.indexs[t]+1>e-this.equalOrLess2(e)?0:this.indexs[t]++},changeAvatar(t){this.user.avatar=URL.createObjectURL(t),this.SET_avatar(this.user.avatar)},confirm(){if(this.$refs.form.validate()){const t=new FormData;t.append("username",this.user.username),t.append("introduction",this.user.introduction),this.editProfile(t),this.isOnEditMode=!1}},cancel(){this.user.username=this.originUsername,this.user.introduction=this.originIntroduction,this.isOnEditMode=!1}},watch:{isOnEditMode(t){t&&(this.originUsername=this.user.username,this.originIntroduction=this.user.introduction)}}},C=y,x=(i("fdfc"),i("8336")),T=i("b0af"),$=i("4bd4"),E=i("8654"),O=i("a844"),B=Object(u["a"])(C,s,n,!1,null,"6d9e87c2",null);e["default"]=B.exports;h()(B,{VBtn:x["a"],VCard:T["a"],VForm:$["a"],VIcon:v["a"],VTextField:E["a"],VTextarea:O["a"]})},1681:function(t,e,i){},"1e09":function(t,e,i){},"3e35":function(t,e,i){"use strict";var s=i("9d65"),n=i("4e82"),r=i("c3f0"),o=i("80d2"),a=i("58df");const c=Object(a["a"])(s["a"],Object(n["a"])("windowGroup","v-window-item","v-window"));var l=c.extend().extend().extend({name:"v-window-item",directives:{Touch:r["a"]},props:{disabled:Boolean,reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},value:{required:!1}},data(){return{done:null,isActive:!1,wasCancelled:!1}},computed:{classes(){return this.groupClasses},computedTransition(){return this.windowGroup.internalReverse?"undefined"!==typeof this.reverseTransition?this.reverseTransition||"":this.windowGroup.computedTransition:"undefined"!==typeof this.transition?this.transition||"":this.windowGroup.computedTransition}},mounted(){this.$el.addEventListener("transitionend",this.onTransitionEnd,!1)},beforeDestroy(){this.$el.removeEventListener("transitionend",this.onTransitionEnd,!1)},methods:{genDefaultSlot(){return this.$slots.default},genWindowItem(){return this.$createElement("div",{staticClass:"v-window-item",class:this.classes,directives:[{name:"show",value:this.isActive}],on:this.$listeners},this.showLazyContent(this.genDefaultSlot()))},onAfterEnter(){this.wasCancelled?this.wasCancelled=!1:requestAnimationFrame(()=>{this.windowGroup.internalHeight=void 0,this.windowGroup.isActive=!1})},onBeforeEnter(){this.windowGroup.isActive=!0},onBeforeLeave(t){this.windowGroup.internalHeight=Object(o["f"])(t.clientHeight)},onEnterCancelled(){this.wasCancelled=!0},onEnter(t,e){const i=this.windowGroup.isBooted;i&&(this.done=e),this.$nextTick(()=>{if(!this.computedTransition)return e();this.windowGroup.internalHeight=Object(o["f"])(t.clientHeight),!i&&setTimeout(e,100)})},onTransitionEnd(t){"transform"===t.propertyName&&t.target===this.$el&&this.done&&(this.done(),this.done=null)}},render(t){return t("transition",{props:{name:this.computedTransition},on:{afterEnter:this.onAfterEnter,beforeEnter:this.onBeforeEnter,beforeLeave:this.onBeforeLeave,enter:this.onEnter,enterCancelled:this.onEnterCancelled}},[this.genWindowItem()])}}),u=i("adda"),d=i("1c87");const h=Object(a["a"])(l,d["a"]);e["a"]=h.extend({name:"v-carousel-item",inheritAttrs:!1,methods:{genDefaultSlot(){return[this.$createElement(u["a"],{staticClass:"v-carousel__item",props:{...this.$attrs,height:this.windowGroup.internalHeight},on:this.$listeners},this.$slots.default)]},genWindowItem(){const{tag:t,data:e}=this.generateRouteLink();return e.staticClass="v-window-item",e.directives.push({name:"show",value:this.isActive}),this.$createElement(t,e,this.showLazyContent(this.genDefaultSlot()))},onBeforeEnter(){},onEnter(){},onAfterEnter(){},onEnterCancelled(){}}})},"4bd4":function(t,e,i){"use strict";var s=i("3206");e["a"]=Object(s["b"])("form").extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>{return t.$watch("hasError",e=>{this.$set(this.errorBag,t._uid,e)},{immediate:!0})},i={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?i.shouldValidate=t.$watch("shouldValidate",s=>{s&&(this.errorBag.hasOwnProperty(t._uid)||(i.valid=e(t)))}):i.valid=e(t),i},validate(){return 0===this.inputs.filter(t=>!t.validate(!0)).length},reset(){this.inputs.forEach(t=>t.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(t=>t.resetValidation()),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find(e=>e._uid===t._uid);if(!e)return;const i=this.watchers.find(t=>t._uid===e._uid);i&&(i.valid(),i.shouldValidate()),this.watchers=this.watchers.filter(t=>t._uid!==e._uid),this.inputs=this.inputs.filter(t=>t._uid!==e._uid),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.$attrs},on:{submit:t=>this.$emit("submit",t)}},this.$slots.default)}})},"52f9":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",{staticClass:"little-card-root"},[i("v-carousel",{attrs:{height:"144","hide-delimiter-background":"","hide-delimiters":"","next-icon":1!==t.images.length&&"$vuetify.icons.next","prev-icon":1!==t.images.length&&"$vuetify.icons.prev"}},t._l(t.images,function(t){return i("v-carousel-item",{key:t,attrs:{src:t}})}),1),i("div",{staticClass:"card-content"},[i("rating-favorite",{attrs:{item:t.item,type:t.type}})],1)],1)},n=[],r=i("d22d"),o={components:{RatingFavorite:r["a"]},props:{item:{type:Object,default:()=>({})},type:String},data(){return{images:[]}},created(){"site"===this.type?this.images=this.item.photos:this.images=this.item.images,0===this.images.length&&this.images.push(i("aa53"))}},a=o,c=(i("c7ca"),i("2877")),l=i("6544"),u=i.n(l),d=i("b0af"),h=i("5e66"),m=i("3e35"),v=Object(c["a"])(a,s,n,!1,null,null,null);e["a"]=v.exports;u()(v,{VCard:d["a"],VCarousel:h["a"],VCarouselItem:m["a"]})},"5e66":function(t,e,i){"use strict";i("63b7");var s=i("f665"),n=i("afdd"),r=i("9d26"),o=i("37c6"),a=i("604c"),c=a["a"].extend({name:"button-group",provide(){return{btnToggle:this}},computed:{classes(){return a["a"].options.computed.classes.call(this)}},methods:{genData:a["a"].options.methods.genData}}),l=i("80d2"),u=i("d9bd");e["a"]=s["a"].extend({name:"v-carousel",props:{continuous:{type:Boolean,default:!0},cycle:Boolean,delimiterIcon:{type:String,default:"$vuetify.icons.delimiter"},height:{type:[Number,String],default:500},hideDelimiters:Boolean,hideDelimiterBackground:Boolean,interval:{type:[Number,String],default:6e3,validator:t=>t>0},mandatory:{type:Boolean,default:!0},progress:Boolean,progressColor:String,showArrows:{type:Boolean,default:!0},verticalDelimiters:{type:String,default:void 0}},data(){return{internalHeight:this.height,slideTimeout:void 0}},computed:{classes(){return{...s["a"].options.computed.classes.call(this),"v-carousel":!0,"v-carousel--hide-delimiter-background":this.hideDelimiterBackground,"v-carousel--vertical-delimiters":this.isVertical}},isDark(){return this.dark||!this.light},isVertical(){return null!=this.verticalDelimiters}},watch:{internalValue:"restartTimeout",interval:"restartTimeout",height(t,e){t!==e&&t&&(this.internalHeight=t)},cycle(t){t?this.restartTimeout():(clearTimeout(this.slideTimeout),this.slideTimeout=void 0)}},created(){this.$attrs.hasOwnProperty("hide-controls")&&Object(u["a"])("hide-controls",':show-arrows="false"',this)},mounted(){this.startTimeout()},methods:{genControlIcons(){return this.isVertical?null:s["a"].options.methods.genControlIcons.call(this)},genDelimiters(){return this.$createElement("div",{staticClass:"v-carousel__controls",style:{left:"left"===this.verticalDelimiters&&this.isVertical?0:"auto",right:"right"===this.verticalDelimiters?0:"auto"}},[this.genItems()])},genItems(){const t=this.items.length,e=[];for(let i=0;i<t;i++){const t=this.$createElement(n["a"],{staticClass:"v-carousel__controls__item",props:{icon:!0,small:!0,value:this.getValue(this.items[i],i)}},[this.$createElement(r["a"],{props:{size:18}},this.delimiterIcon)]);e.push(t)}return this.$createElement(c,{props:{value:this.internalValue},on:{change:t=>{this.internalValue=t}}},e)},genProgress(){return this.$createElement(o["a"],{staticClass:"v-carousel__progress",props:{color:this.progressColor,value:(this.internalIndex+1)/this.items.length*100}})},restartTimeout(){this.slideTimeout&&clearTimeout(this.slideTimeout),this.slideTimeout=void 0,window.requestAnimationFrame(this.startTimeout)},startTimeout(){this.cycle&&(this.slideTimeout=window.setTimeout(this.next,+this.interval>0?+this.interval:6e3))}},render(t){const e=s["a"].options.render.call(this,t);return e.data.style=`height: ${Object(l["f"])(this.height)};`,this.hideDelimiters||e.children.push(this.genDelimiters()),(this.progress||this.progressColor)&&e.children.push(this.genProgress()),e}})},"62ba":function(t,e,i){},"63b7":function(t,e,i){},9640:function(t,e,i){},"9d65":function(t,e,i){"use strict";var s=i("d9bd"),n=i("2b0e");e["a"]=n["a"].extend().extend({name:"bootable",props:{eager:Boolean},data:()=>({isBooted:!1}),computed:{hasContent(){return this.isBooted||this.eager||this.isActive}},watch:{isActive(){this.isBooted=!0}},created(){"lazy"in this.$attrs&&Object(s["d"])("lazy",this)},methods:{showLazyContent(t){return this.hasContent?t:void 0}}})},a844:function(t,e,i){"use strict";i("1681");var s=i("8654"),n=i("58df");const r=Object(n["a"])(s["a"]);e["a"]=r.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:t=>!isNaN(parseFloat(t))},rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseInt(t,10))}},computed:{classes(){return{"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle,...s["a"].options.computed.classes.call(this)}},noResizeHandle(){return this.noResize||this.autoGrow}},watch:{lazyValue(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted(){setTimeout(()=>{this.autoGrow&&this.calculateInputHeight()},0)},methods:{calculateInputHeight(){const t=this.$refs.input;if(!t)return;t.style.height="0";const e=t.scrollHeight,i=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(i,e)+"px"},genInput(){const t=s["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput(t){s["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}})},aa53:function(t,e,i){t.exports=i.p+"img/5.ccc16904.jpg"},b763:function(t,e,i){"use strict";var s=i("029e"),n=i.n(s);n.a},c7ca:function(t,e,i){"use strict";var s=i("1e09"),n=i.n(s);n.a},c83b:function(t,e,i){"use strict";var s=i("62ba"),n=i.n(s);n.a},d22d:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rating-favorite-root"},[i("h4",{on:{click:function(e){return t.changeRouter(t.id)}}},[t._v(t._s(t.name))]),i("div",[i("v-icon",{attrs:{size:"15",color:"#FB9026"}},[t._v("star")]),i("span",{style:{color:"#FB9026"}},[t._v(t._s(t.rating))]),i("span",{style:{color:"#999999"}},[t._v("  ( "+t._s(t.commentCounts)+"則評論 | "+t._s(t.collectingCounts+t.counts?t.collectingCounts+t.counts:0)+" 人將此收藏 )")])],1),t.item.userId!==t.accountId?i("v-icon",{staticClass:"favorite-icon",style:{color:t.showWhichIcon?"red":"grey"},on:{mouseover:function(e){t.isOnHover=!0},mouseout:function(e){t.isOnHover=!1},click:function(e){return t.toggle(t.id)}}},[t._v(t._s(t.showWhichIcon?"favorite":"favorite_border"))]):t._e(),t._t("cancel")],2)},n=[],r=i("2f62"),o={props:{item:Object,type:String},data(){return{isOnHover:!1,name:"",rating:0,commentCounts:0,collectingCounts:0,counts:0,id:""}},created(){this.name=this.item.name,this.rating=this.item.rating,this.collectingCounts=this.item.collectingCounts,"site"===this.type?(this.commentCounts=this.item.reviews.length?this.item.reviews.length:0,this.id=this.item.placeId):(this.commentCounts=this.item.comments.length,this.id=this.item._id)},computed:{...Object(r["c"])("account",{accountId:"getAccountId",collectingSites:"getCollectingSites",collectingTrips:"getCollectingTrips"}),isFavorite(){return"site"===this.type?this.collectingSites.includes(this.id):this.collectingTrips.includes(this.id)},showWhichIcon(){return this.isFavorite?!this.isOnHover:this.isOnHover}},methods:{...Object(r["b"])("account",["toggleCollectedSite","toggleCollectedTrip"]),toggle(t){"site"===this.type?this.toggleCollectedSite(t):this.toggleCollectedTrip(t),this.isFavorite?this.counts+=1:this.counts-=1},changeRouter(t){if("site"===this.type){if("Site"===this.$route.name)return;this.$router.push(`/sites/${t}`)}else this.$router.push(`/trips/${t}`)}}},a=o,c=(i("b763"),i("2877")),l=i("6544"),u=i.n(l),d=i("132d"),h=Object(c["a"])(a,s,n,!1,null,null,null);e["a"]=h.exports;u()(h,{VIcon:d["a"]})},fdfc:function(t,e,i){"use strict";var s=i("9640"),n=i.n(s);n.a}}]);
//# sourceMappingURL=chunk-623010c9.945397a3.js.map